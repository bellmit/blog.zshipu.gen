title: dart 线程
author: 知识铺
date: 2020-09-13 13:53:36
tags:
---

# 线程

[参考这里](https://juejin.im/post/5d7f5e7c6fb9a06b0c089920)  

- 在开发中，我们经常会遇到一些耗时的操作需要完成，比如网络请求、文件读取等等；
- 如果我们的主线程一直在等待这些耗时的操作完成，那么就会进行阻塞，无法响应其它事件，比如用户的点击；

不同的语言有不同的处理方式, Dart是单线程的。

**处理方式一：** 多线程，比如Java、C++，我们普遍的做法是开启一个新的线程（Thread），在新的线程中完成这些异步的操作，再通过线程间通信的方式，将拿到的数据传递给主线程。

**处理方式二：** 单线程+事件循环，比如JavaScript、Dart都是基于单线程加事件循环来完成耗时操作的处理

#### 单线程的异步操作

在单线程环境中, 类似于网络请求、文件读写的IO，可以基于非阻塞调用. 阻塞和非阻塞关注的是**程序在等待调用结果（消息，返回值）时的状态。**
**阻塞式调用：** 调用结果返回之前，当前线程会被挂起，调用线程只有在得到调用结果之后才会继续执行。
**非阻塞式调用：** 调用执行之后，当前线程不会停止执行，只需要过一段时间来检查一下有没有结果返回即可

而我们开发中的很多耗时操作，都可以基于这样的 `非阻塞式调用`：
- 比如网络请求本身使用了Socket通信，而Socket本身提供了select模型，可以进行`非阻塞方式的工作`；
- 比如文件读写的IO操作，我们可以使用操作系统提供的`基于事件的回调机制`；

这些操作都不会阻塞我们单线程的继续执行，我们的线程在等待的过程中可以继续去做别的事情

